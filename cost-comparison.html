<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMD TCO Comparison Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- 全局樣式 (AMD Dark Mode) --- */
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            background-color: #121212; /* 深黑背景 */
            color: #e0e0e0; /* 淺灰文字 */
            display: flex; 
            height: 100vh; 
            flex-direction: column;
        }

        /* 頂部標題列 */
        header { 
            background-color: #000000; 
            color: white; 
            padding: 0 25px; 
            height: 60px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 3px solid #ED1C24; /* AMD 紅色底線 */
            box-shadow: 0 4px 15px rgba(237, 28, 36, 0.2); 
            flex-shrink: 0;
        }
        .brand { font-weight: 800; font-size: 24px; letter-spacing: 1px; display: flex; align-items: center; gap: 10px; }
        .title { font-size: 16px; font-weight: 400; text-transform: uppercase; color: #ccc; letter-spacing: 1px; }

        /* 主佈局 */
        .container { display: flex; flex: 1; height: calc(100vh - 60px); }

        /* 左側控制區 */
        .sidebar {
            width: 340px;
            background-color: #1e1e1e;
            padding: 25px;
            border-right: 1px solid #333;
            overflow-y: auto;
        }

        h2 { 
            color: #ED1C24; 
            border-bottom: 1px solid #444; 
            padding-bottom: 10px; 
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 25px;
        }
        
        .control-section { 
            margin-bottom: 30px; 
            background: #252525;
            border: 1px solid #333; 
            padding: 15px; 
            border-radius: 4px; 
        }
        .control-section h3 { 
            margin-top: 0; 
            font-size: 14px; 
            color: #ccc; 
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 13px; color: #aaa; margin-top: 15px; }
        
        /* 滑桿樣式 (AMD Red vs Grey) */
        input[type="range"] { 
            width: 100%; height: 4px; background: #444; border-radius: 2px; outline: none; appearance: none; -webkit-appearance: none; cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb { 
            appearance: none; -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; border: 2px solid #121212; cursor: pointer; transition: transform 0.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

        /* A 方案 (灰色) */
        #inputA_init::-webkit-slider-thumb, #inputA_ops::-webkit-slider-thumb { background: #999; }
        
        /* B 方案 (紅色) */
        #inputB_init::-webkit-slider-thumb, #inputB_ops::-webkit-slider-thumb { background: #ED1C24; box-shadow: 0 0 5px rgba(237, 28, 36, 0.5); }

        .val-display { float: right; color: #fff; font-weight: bold; }

        /* 右側內容區 */
        .main-content { flex: 1; padding: 40px; display: flex; flex-direction: column; align-items: center; overflow-y: auto; }
        
        .chart-box { 
            width: 90%; 
            background: #1e1e1e; 
            padding: 20px; 
            border-radius: 4px; 
            border: 1px solid #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            min-height: 350px;
        }
        
        /* 結果摘要卡片 */
        .result-cards { display: flex; gap: 20px; margin-bottom: 30px; width: 90%; }
        
        .card { 
            flex: 1; 
            background: #1e1e1e; 
            padding: 20px; 
            border-radius: 4px; 
            text-align: center; 
            border: 1px solid #333;
            border-top: 3px solid #555; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .card h4 { margin: 0; font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .card h2 { margin: 10px 0 0; font-size: 24px; color: #fff; border: none; padding: 0; }

        /* 贏家樣式 (Dark Mode Green) */
        .card.winner { 
            border-top-color: #28a745; 
            background: linear-gradient(to bottom, rgba(40, 167, 69, 0.1), #1e1e1e); 
            border-color: #28a745;
        } 
        /* B 方案贏家用紅色強調 (可選，這裡先維持綠色代表省錢) */

    </style>
</head>
<body>

    <header>
        <div class="brand">
            <span style="font-size: 28px;">AMD</span> 
            <i class="fas fa-arrow-right" style="font-size: 20px; color: #ED1C24; transform: rotate(-45deg);"></i>
        </div>
        <div class="title">TCO & ROI Calculator</div>
    </header>

    <div class="container">
        <div class="sidebar">
            <h2>Parameters (輸入參數)</h2>

            <div class="control-section" style="border-left: 3px solid #999;">
                <h3><i class="fas fa-history" style="color:#999;"></i> Plan A (Legacy/Old)</h3>
                
                <label>Initial Cost ($) <span id="valA_init" class="val-display" style="color:#999">0</span></label>
                <input type="range" id="inputA_init" min="0" max="50000" step="1000" value="0">
                
                <label>Annual OpEx ($) <span id="valA_ops" class="val-display" style="color:#999">8000</span></label>
                <input type="range" id="inputA_ops" min="1000" max="20000" step="500" value="8000">
            </div>

            <div class="control-section" style="border-left: 3px solid #ED1C24;">
                <h3><i class="fas fa-rocket" style="color:#ED1C24;"></i> Plan B (AMD/New)</h3>
                
                <label>Initial Cost ($) <span id="valB_init" class="val-display" style="color:#ED1C24">20000</span></label>
                <input type="range" id="inputB_init" min="0" max="100000" step="1000" value="20000">
                
                <label>Annual OpEx ($) <span id="valB_ops" class="val-display" style="color:#ED1C24">3000</span></label>
                <input type="range" id="inputB_ops" min="1000" max="20000" step="500" value="3000">
            </div>
        </div>

        <div class="main-content">
            <div class="result-cards">
                <div class="card" id="cardA">
                    <h4>Plan A Total (10 Years)</h4>
                    <h2 id="totalA">$0</h2>
                </div>
                <div class="card" id="cardB">
                    <h4>Plan B Total (10 Years)</h4>
                    <h2 id="totalB">$0</h2>
                </div>
                <div class="card" style="border-top-color: #ff9800;">
                    <h4>Break-even Point</h4>
                    <h2 id="breakeven" style="color: #ff9800;">Calculating...</h2>
                </div>
            </div>

            <div class="chart-box">
                <canvas id="costChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Chart.js 深色模式設定
        Chart.defaults.color = '#ccc';
        Chart.defaults.scale.grid.color = '#333';

        // 1. 抓取元素
        const inputs = {
            a_init: document.getElementById('inputA_init'),
            a_ops:  document.getElementById('inputA_ops'),
            b_init: document.getElementById('inputB_init'),
            b_ops:  document.getElementById('inputB_ops')
        };

        // 2. 初始化圖表
        const ctx = document.getElementById('costChart').getContext('2d');
        const costChart = new Chart(ctx, {
            type: 'line', 
            data: {
                labels: ['Y0', 'Y1', 'Y2', 'Y3', 'Y4', 'Y5', 'Y6', 'Y7', 'Y8', 'Y9', 'Y10'], 
                datasets: [
                    {
                        label: 'Plan A (Legacy) Cumulative Cost',
                        data: [],
                        borderColor: '#999', // 灰色線
                        backgroundColor: 'rgba(153, 153, 153, 0.1)',
                        pointBackgroundColor: '#999',
                        fill: false,
                        tension: 0.3
                    },
                    {
                        label: 'Plan B (AMD) Cumulative Cost',
                        data: [],
                        borderColor: '#ED1C24', // AMD 紅色線
                        backgroundColor: 'rgba(237, 28, 36, 0.1)',
                        pointBackgroundColor: '#ED1C24',
                        fill: false,
                        tension: 0.3
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                scales: {
                    y: { 
                        title: { display: true, text: 'Cumulative Cost ($)', color: '#888' },
                        grid: { color: '#333' }
                    },
                    x: {
                        grid: { color: '#333' }
                    }
                },
                plugins: {
                    tooltip: {
                        backgroundColor: 'rgba(0,0,0,0.9)',
                        titleColor: '#fff',
                        bodyColor: '#ccc'
                    }
                }
            }
        });

        // 3. 計算邏輯
        function calculate() {
            // 讀取數值
            let a_init = parseInt(inputs.a_init.value);
            let a_ops  = parseInt(inputs.a_ops.value);
            let b_init = parseInt(inputs.b_init.value);
            let b_ops  = parseInt(inputs.b_ops.value);

            // 更新左側文字顯示
            document.getElementById('valA_init').innerText = a_init;
            document.getElementById('valA_ops').innerText  = a_ops;
            document.getElementById('valB_init').innerText = b_init;
            document.getElementById('valB_ops').innerText  = b_ops;

            // 產生 10 年的數據
            let dataA = [];
            let dataB = [];
            let years = 10;
            let breakEvenYear = "No Cross";

            for(let i = 0; i <= years; i++) {
                let costA = a_init + (i * a_ops);
                let costB = b_init + (i * b_ops);
                
                dataA.push(costA);
                dataB.push(costB);

                if (i > 0 && costB < costA && dataB[i-1] >= dataA[i-1]) {
                    breakEvenYear = "Year " + i;
                }
            }

            // 更新圖表
            costChart.data.datasets[0].data = dataA;
            costChart.data.datasets[1].data = dataB;
            costChart.update();

            // 更新摘要
            let finalA = dataA[10];
            let finalB = dataB[10];
            document.getElementById('totalA').innerText = "$" + finalA.toLocaleString();
            document.getElementById('totalB').innerText = "$" + finalB.toLocaleString();
            document.getElementById('breakeven').innerText = breakEvenYear;

            // 贏家特效
            document.getElementById('cardA').classList.toggle('winner', finalA < finalB);
            document.getElementById('cardB').classList.toggle('winner', finalB < finalA);
        }

        // 4. 綁定事件
        Object.values(inputs).forEach(input => {
            input.addEventListener('input', calculate);
        });

        // 啟動
        calculate();
    </script>
</body>
</html>